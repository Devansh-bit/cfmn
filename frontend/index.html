<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <title>Vite + React + TS</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx">

    </script>
  // <script>
    (function() {
      'use strict';

      // Block One Tap from the very beginning
      let oneTapBlocked = false;

      // Observer to remove One Tap elements as they appear
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          mutation.addedNodes.forEach(function(node) {
            if (node.nodeType === 1) { // Element node
              // Check if this is a One Tap element
              if (
                      node.id === 'credential_picker_container' ||
                      node.classList?.contains('g_id_signin') ||
                      node.hasAttribute?.('data-auto-select') ||
                      node.src?.includes('accounts.google.com/gsi/iframe') ||
                      (node.tagName === 'IFRAME' && node.src?.includes('accounts.google.com'))
              ) {
                console.log('Blocking One Tap element:', node);
                node.remove();
                oneTapBlocked = true;
              }

              // Check child elements too
              const oneTapElements = node.querySelectorAll?.(
                      '#credential_picker_container, .g_id_signin, [data-auto-select], iframe[src*="accounts.google.com"]'
              );
              oneTapElements?.forEach(el => {
                console.log('Blocking child One Tap element:', el);
                el.remove();
                oneTapBlocked = true;
              });
            }
          });
        });
      });

      // Start observing
      observer.observe(document.body, {
        childList: true,
        subtree: true
      });

      // Override Google's prompt method
      const originalDefineProperty = Object.defineProperty;
      Object.defineProperty = function(obj, prop, descriptor) {
        if (prop === 'google' && descriptor?.value?.accounts?.id?.prompt) {
          console.log('Blocking Google One Tap prompt method');
          descriptor.value.accounts.id.prompt = function() {
            console.log('One Tap prompt blocked');
            return;
          };
        }
        return originalDefineProperty.call(this, obj, prop, descriptor);
      };

      // Block if Google is already loaded
      document.addEventListener('DOMContentLoaded', function() {
        if (window.google?.accounts?.id) {
          try {
            window.google.accounts.id.cancel();
            window.google.accounts.id.disableAutoSelect();
            // Override the prompt method
            window.google.accounts.id.prompt = function() {
              console.log('One Tap prompt permanently blocked');
              return;
            };
            console.log('One Tap blocked on DOM ready');
          } catch (e) {
            console.log('Error blocking One Tap:', e);
          }
        }
      });

      // Cleanup observer after 30 seconds
      setTimeout(() => {
        observer.disconnect();
        if (oneTapBlocked) {
          console.log('One Tap blocking completed');
        }
      }, 30000);
    })();
    // </script>
  </body>
</html>
